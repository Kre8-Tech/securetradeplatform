{"ast":null,"code":"// frontend/src/components/AdminWhatsNew.js\nimport React,{useEffect,useState}from'react';import axios from'axios';import'./Panel.css';// Use panel.css for consistent styling\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminWhatsNew=()=>{const[posts,setPosts]=useState([]);const[newPost,setNewPost]=useState({type:'news',message:''});const[error,setError]=useState(null);const token=localStorage.getItem('token');useEffect(()=>{const fetchPosts=async()=>{if(!token){setError('You must log in first.');return;}try{const response=await axios.get('http://localhost:5000/api/whats-new',{headers:{Authorization:`Bearer ${token}`}});setPosts(response.data);}catch(err){console.error('Error fetching posts:',err);setError('Failed to fetch posts.');}};fetchPosts();},[token]);const handleSubmit=async e=>{e.preventDefault();setError(null);// Reset errors\ntry{const response=await axios.post('http://localhost:5000/api/admin/whats-new',newPost,{headers:{Authorization:`Bearer ${token}`}});setPosts([response.data,...posts]);// Add new post to top\nsetNewPost({type:'news',message:''});alert('Update posted successfully.');}catch(err){console.error('Error posting update:',err);setError('Failed to post update. Admin privileges required.');}};const handleInputChange=e=>{const{name,value}=e.target;setNewPost({...newPost,[name]:value});};if(!token)return/*#__PURE__*/_jsx(\"p\",{children:\"You must log in first.\"});if(error)return/*#__PURE__*/_jsx(\"p\",{children:error});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Manage What's New\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Type:\",/*#__PURE__*/_jsxs(\"select\",{name:\"type\",value:newPost.type,onChange:handleInputChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"news\",children:\"News\"}),/*#__PURE__*/_jsx(\"option\",{value:\"offer\",children:\"Special Offer\"}),/*#__PURE__*/_jsx(\"option\",{value:\"update\",children:\"Platform Update\"})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Message:\",/*#__PURE__*/_jsx(\"textarea\",{name:\"message\",value:newPost.message,onChange:handleInputChange,placeholder:\"Enter your announcement here\",required:true})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Publish Update\"})]}),error&&/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"h3\",{children:\"Published Announcements\"}),posts.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No announcements yet\"}):/*#__PURE__*/_jsx(\"ul\",{children:posts.map(post=>/*#__PURE__*/_jsxs(\"li\",{children:[post.type==='news'?'ðŸ“° News':post.type==='offer'?'ðŸŽ‰ Offer':'ðŸ†• Update',\" -\",' ',new Date(post.date).toLocaleDateString(),\" - \",post.message]},post.id))})]});};export default AdminWhatsNew;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","AdminWhatsNew","posts","setPosts","newPost","setNewPost","type","message","error","setError","token","localStorage","getItem","fetchPosts","response","get","headers","Authorization","data","err","console","handleSubmit","e","preventDefault","post","alert","handleInputChange","name","value","target","children","onSubmit","onChange","placeholder","required","length","map","Date","date","toLocaleDateString","id"],"sources":["C:/securetradeplatform/frontend/src/components/AdminWhatsNew.js"],"sourcesContent":["// frontend/src/components/AdminWhatsNew.js\r\nimport React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport './Panel.css'; // Use panel.css for consistent styling\r\n\r\nconst AdminWhatsNew = () => {\r\n  const [posts, setPosts] = useState([]);\r\n  const [newPost, setNewPost] = useState({ type: 'news', message: '' });\r\n  const [error, setError] = useState(null);\r\n  const token = localStorage.getItem('token');\r\n\r\n  useEffect(() => {\r\n    const fetchPosts = async () => {\r\n      if (!token) {\r\n        setError('You must log in first.');\r\n        return;\r\n      }\r\n      try {\r\n        const response = await axios.get('http://localhost:5000/api/whats-new', {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        setPosts(response.data);\r\n      } catch (err) {\r\n        console.error('Error fetching posts:', err);\r\n        setError('Failed to fetch posts.');\r\n      }\r\n    };\r\n    fetchPosts();\r\n  }, [token]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError(null); // Reset errors\r\n    try {\r\n      const response = await axios.post('http://localhost:5000/api/admin/whats-new', newPost, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setPosts([response.data, ...posts]); // Add new post to top\r\n      setNewPost({ type: 'news', message: '' });\r\n      alert('Update posted successfully.');\r\n    } catch (err) {\r\n      console.error('Error posting update:', err);\r\n      setError('Failed to post update. Admin privileges required.');\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setNewPost({ ...newPost, [name]: value });\r\n  };\r\n\r\n  if (!token) return <p>You must log in first.</p>;\r\n  if (error) return <p>{error}</p>;\r\n\r\n  return (\r\n    <div>\r\n      <h2>Manage What's New</h2>\r\n      <form onSubmit={handleSubmit}>\r\n        <label>\r\n          Type:\r\n          <select name=\"type\" value={newPost.type} onChange={handleInputChange}>\r\n            <option value=\"news\">News</option>\r\n            <option value=\"offer\">Special Offer</option>\r\n            <option value=\"update\">Platform Update</option>\r\n          </select>\r\n        </label>\r\n        <br />\r\n        <label>\r\n          Message:\r\n          <textarea\r\n            name=\"message\"\r\n            value={newPost.message}\r\n            onChange={handleInputChange}\r\n            placeholder=\"Enter your announcement here\"\r\n            required\r\n          />\r\n        </label>\r\n        <br />\r\n        <button type=\"submit\">Publish Update</button>\r\n      </form>\r\n      {error && <p>{error}</p>}\r\n      <h3>Published Announcements</h3>\r\n      {posts.length === 0 ? (\r\n        <p>No announcements yet</p>\r\n      ) : (\r\n        <ul>\r\n          {posts.map((post) => (\r\n            <li key={post.id}>\r\n              {post.type === 'news' ? 'ðŸ“° News' : post.type === 'offer' ? 'ðŸŽ‰ Offer' : 'ðŸ†• Update'} -{' '}\r\n              {new Date(post.date).toLocaleDateString()} - {post.message}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminWhatsNew;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}